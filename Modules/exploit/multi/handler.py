from posixpath import expanduser
from SpiritCore.Modules import *
from SpiritCore.Session import *
import uuid
class Module(Modules):
    Info = {
        "Name": "Test",
        "Author": "ZSD",
        "Description": "Test ",
        "Options": (
            ("ExitFunc", "thread", True, 'Exit Function Thread Apc', None),
        ),
        "Payload": ["windows/spiriter", "Windows Ring3 ShellCode"],

    }

    def Exploit(self):
        # write(self.Parameate)
        SessionObj = Session(self.Object)
        SessionObj.TargetOS =self.Object.UsePayloadObject.OS
        SessionObj.PayloadType=self.Object.UsePayloadObject.Type
        SessionObj.SObject=self.Object
        WriteLogs("Call Payload the Handler %s"%self.Object.UsePayloadObject.Name)

        SessionObj.start()
        try:
            SessionObj.Console("")
        except Exception as error:
            write("Error Handler:Exploit:30")
            print_error(error.__str__())
            return
    def Generate(self,File,Type="exe"):
        print_msg("Generate Type:%s"%Type)
        try:
            self.Object.UsePayloadObject.GenerateFile(self.Parameate,File,Type)
        except Exception as error:
            print_error(error.__str__())
